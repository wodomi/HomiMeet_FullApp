{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<style>
  body {
    background: #f7f9fb;
    min-height: 100vh;
  }

  .dashboard-card {
    background: transparent;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    text-align: center;
    max-width: 500px;
    margin: auto;
  }

  .dashboard-card img {
    max-height: 70px;
    margin-bottom: 1rem;
  }

  .dashboard-card h2 {
    font-weight: 700;
    color: #333;
    margin-bottom: 0.3rem;
  }

  .dashboard-card p {
    color: #6c757d;
    margin-bottom: 2rem;
  }

  .score-circle {
    position: relative;
    width: 140px;
    height: 140px;
    border-radius: 50%;
    background: conic-gradient(#4caf50 0%, #e0e0e0 0%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: bold;
    color: #333;
    margin: auto;
    transition: background 0.3s linear;
  }

  .score-circle span {
    position: absolute;
  }

  @keyframes pulse {
    0% { transform: scale(1); box-shadow: 0 0 0 rgba(76,175,80, 0.4); }
    50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(76,175,80, 0.5); }
    100% { transform: scale(1); box-shadow: 0 0 0 rgba(76,175,80, 0.4); }
  }

  .pulse {
    animation: pulse 0.8s ease-in-out;
  }
</style>

<div class="container py-5">
  <div class="dashboard-card">
    <img src="{{ url_for('static', filename='images/homimeet_logo.png') }}" 
         alt="HomiMeet Logo">
    
    <h2>Welcome, {{ username }}!</h2>
    <p>Hereâ€™s your meetup performance overview.</p>

    <div class="score-circle" id="scoreCircle">
      <span id="scoreText">{{ avg_score }}%</span>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    let targetScore = parseInt('{{ avg_score|int }}', 10);
    let currentScore = 0;
    let scoreCircle = document.getElementById("scoreCircle");
    let scoreText = document.getElementById("scoreText");

    let interval = setInterval(function() {
      if (currentScore >= targetScore) {
        clearInterval(interval);
        scoreCircle.classList.add("pulse");
        setTimeout(() => scoreCircle.classList.remove("pulse"), 800);
      } else {
        currentScore++;
        scoreText.textContent = currentScore + "%";
        scoreCircle.style.background = `conic-gradient(#4caf50 ${currentScore}%, #e0e0e0 ${currentScore}%)`;
      }
    }, 20);
  });
</script>
{% endblock %}
